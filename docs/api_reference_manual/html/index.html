<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HTTP Client Middleware Library: Overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen_style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="http://www.cypress.com/"><img alt="Logo" src="cypress_logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HTTP Client Middleware Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Overview </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This library provides the HTTP Client implementation that can work on the PSoC 6 MCU platforms with Wi-Fi connectivity.This library supports RESTful methods such as GET, PUT, POST and HEAD to communicate with the HTTP Server.</p>
<h1><a class="anchor" id="section_features"></a>
Features</h1>
<ul>
<li>Secure [with TLS security] and non-secure modes of connection.</li>
<li>Supports RESTful HTTP methods: GET, PUT, POST and HEAD.</li>
<li>Handles various resource content types such as HTML, Plain, and JSON.</li>
<li>Provides synchronous API to send the request and receive the response.</li>
<li>Provide utility APIs to create HTTP headers for forming the HTTP request. And to parse the HTTP headers received in the response.</li>
<li>Supports large data downloads through range requests.</li>
</ul>
<h1><a class="anchor" id="section_AnyCloud_state_machine"></a>
AnyCloud State Machine</h1>
<p>The HTTP Client library provides C APIs in AnyCloud framework to send HTTP request to the server and receive the response. API state machine to perform HTTP send request operation is given below.</p>
<h2><a class="anchor" id="section_AnyCloud_state_machine_1"></a>
AnyCloud - HTTP Client send request</h2>
<pre class="fragment">          +-----------------------+
          | cy_http_client_init() |
          +-----------------------+
                     |
                     v
        +----------------------------+
        |    cy_http_client_create() |
        +----------------------------+
                     |
                     v
         +--------------------------+
         | cy_http_client_connect() |
         +--------------------------+
                     |
                     v
       +------------------------------+
       | cy_http_client_write_header()|
       +------------------------------+
                     |
                     v
          +-----------------------+
          | cy_http_client_send() |
          +-----------------------+
                     |
                     v
        +-----------------------------+
        | cy_http_client_disconnect() |
        +-----------------------------+
                     |
                     v
          +-------------------------+
          | cy_http_client_delete() |
          +-------------------------+
                     |
                     v
          +-------------------------+
          | cy_http_client_deinit() |
          +-------------------------+
</pre><h1><a class="anchor" id="section_platform"></a>
Supported Platform</h1>
<h2><a class="anchor" id="section_plat_anycloud"></a>
AnyCloud</h2>
<ul>
<li><a href="https://www.cypress.com/documentation/development-kitsboards/psoc-6-wi-fi-bt-prototyping-kit-cy8cproto-062-4343w">PSoC 6 WiFi-BT Prototyping Kit (CY8CPROTO-062-4343W)</a></li>
<li><a href="https://www.cypress.com/documentation/development-kitsboards/psoc-62s2-wi-fi-bt-pioneer-kit-cy8ckit-062s2-43012">PSoC 62S2 Wi-Fi BT Pioneer Kit (CY8CKIT-062S2-43012)</a></li>
<li><a href="https://www.cypress.com/documentation/development-kitsboards/psoc-6-wifi-bt-pioneer-kit-cy8ckit-062-wifi-bt">PSoC 6 WiFi-BT Pioneer Kit (CY8CKIT-062-WiFi-BT)</a></li>
</ul>
<h1><a class="anchor" id="section_frameworks"></a>
Supported Frameworks</h1>
<p>This middleware library supports the following frameworks:</p><ul>
<li>AnyCloud Framework: AnyCloud is a FreeRTOS-based solution. The HTTP Client Library uses the <a href="https://github.com/cypresssemiconductorco/abstraction-rtos">abstraction-rtos</a> library that provides the RTOS abstraction API and uses the <a href="https://github.com/cypresssemiconductorco/secure-sockets">secure-sockets</a> library for implementing socket functions.</li>
</ul>
<h1><a class="anchor" id="section_dependencies"></a>
Dependencies</h1>
<p>This HTTP Client library depends on the following libraries: </p>
<h2><a class="anchor" id="section_dep_anycloud"></a>
AnyCloud</h2>
<ul>
<li><a href="https://github.com/cypresssemiconductorco/wifi-mw-core">Wi-Fi Middleware Core</a></li>
<li><a href="https://github.com/cypresssemiconductorco/aws-iot-device-sdk-port">AWS IOT SDK PORT</a></li>
</ul>
<h1><a class="anchor" id="section_quick_start"></a>
Quick Start</h1>
<p>This library is supported only on AnyCloud framework. The following section provides information on how to build the library in those frameworks.</p>
<h2><a class="anchor" id="framework"></a>
AnyCloud</h2>
<ul>
<li>A set of pre-defined configuration files have been bundled with the wifi-mw-core library for FreeRTOS, lwIP, and mbed TLS. Review the configuration and make the required adjustments. See the "Quick Start" section in <a href="https://github.com/cypresssemiconductorco/wifi-mw-core/blob/master/README.md">README.md</a>.</li>
<li>Define the following COMPONENTS in the application's Makefile for the HTTP Client Library. For additional information, see the "Quick Start" section in <a href="https://github.com/cypresssemiconductorco/wifi-mw-core/blob/master/README.md">README.md</a>. <div class="fragment"><div class="line">COMPONENTS=FREERTOS MBEDTLS LWIP SECURE_SOCKETS</div></div><!-- fragment --></li>
<li>HTTP Client Library disables all the debug log messages by default. To enable log messages, the application must perform the following:<ul>
<li>Add the <code>ENABLE_HTTP_CLIENT_LOGS</code> macro to the <em>DEFINES</em> in the code example's Makefile. The Makefile entry would look as follows: <div class="fragment"><div class="line">DEFINES+=ENABLE_HTTP_CLIENT_LOGS</div></div><!-- fragment --></li>
<li>Call the <code>cy_log_init()</code> function provided by the <em>cy-log</em> module. cy-log is part of the <em>connectivity-utilities</em> library. See <a href="https://cypresssemiconductorco.github.io/connectivity-utilities/api_reference_manual/html/group__logging__utils.html">connectivity-utilities library API documentation</a> for cy-log details.</li>
</ul>
</li>
<li>Define the following macro in the application's Makefile to configure the response header maximum length to 'N'. By default, this value will be set to 2048: <div class="fragment"><div class="line">DEFINES+=HTTP_MAX_RESPONSE_HEADERS_SIZE_BYTES=&lt;N&gt;</div></div><!-- fragment --></li>
<li>Define the following macro in the application's Makefile to configure the user agent name in all request headers. By default, this component will be added to the request header: <div class="fragment"><div class="line">DEFINES += HTTP_USER_AGENT_VALUE=<span class="stringliteral">&quot;\&quot;anycloud-http-client\&quot;&quot;</span></div></div><!-- fragment --></li>
<li>Define the following macro in the application's Makefile to mandatorily disable the custom configuration header file. <div class="fragment"><div class="line">DEFINES += HTTP_DO_NOT_USE_CUSTOM_CONFIG</div><div class="line">DEFINES += MQTT_DO_NOT_USE_CUSTOM_CONFIG</div></div><!-- fragment --></li>
</ul>
<h1><a class="anchor" id="section_code_snippet"></a>
Code Snippets</h1>
<p>This section provides code snippets for this library on the AnyCloud framework. The code snippets given under the AnyCloud section use C APIs. In general, the library features are tested on AnyCloud using C APIs.</p><ul>
<li>AnyCloud - Snippets for HTTP Client create, connect, send, disconnect and delete (C implementation).</li>
</ul>
<h1><a class="anchor" id="section_code_snippet_AnyCloud"></a>
AnyCloud</h1>
<p>This code snippet demonstrates the initialization of the configuration structures required for the operation such as creating a secure or non-secure connection and communicating with the HTTP server using the supported methods.</p>
<h2><a class="anchor" id="snip1"></a>
Code Snippet 1: Creation and Initialization of Handle for Non-Secure HTTP Client</h2>
<p>Creates an HTTP Client handle for a non-secure HTTP connection using the <a class="el" href="group__group__c__api__functions.html#ga541271f1a31f2c10ccd07db315301a14">cy_http_client_create</a> function.* </p><div class="fragment"><div class="line"><span class="preprocessor">#define MAKE_IPV4_ADDRESS(a, b, c, d)     ((((uint32_t) d) &lt;&lt; 24) | \</span></div><div class="line"><span class="preprocessor">                                          (((uint32_t) c) &lt;&lt; 16) | \</span></div><div class="line"><span class="preprocessor">                                          (((uint32_t) b) &lt;&lt; 8) |\</span></div><div class="line"><span class="preprocessor">                                          ((uint32_t) a))</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define SERVER_IP_ADDRESS                 MAKE_IPV4_ADDRESS(192, 168, 18, 9)</span></div><div class="line"><span class="preprocessor">#define SERVER_HOST                       &quot;httpbin.org&quot;</span></div><div class="line"><span class="preprocessor">#define SERVER_PORT                       80</span></div><div class="line"></div><div class="line">cy_awsport_server_info_t server_info;</div><div class="line"><a class="code" href="group__http__client__struct.html#gaa29452c737f81db0bc8923aa83cfe674">cy_http_client_t</a> handle;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> snippet_http_client_non_secure_create( <span class="keywordtype">void</span> )</div><div class="line">{</div><div class="line">    <span class="comment">/* Status variables for various operations. */</span></div><div class="line">    cy_rslt_t TestRes = CY_RSLT_SUCCESS;</div><div class="line">    (void)TestRes;</div><div class="line"></div><div class="line">    server_info.host_name = SERVER_HOST;</div><div class="line">    server_info.port = SERVER_PORT;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the HTTP Client Library. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga1d24d8ba5a892e85ef97877fb0b21482">cy_http_client_init</a>();</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Create an instance of HTTP client. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga541271f1a31f2c10ccd07db315301a14">cy_http_client_create</a>(NULL, &amp;server_info, NULL, &amp;handle);</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path */</span></div><div class="line">    }</div><div class="line"></div><div class="line">}</div></div><!-- fragment --> <h2><a class="anchor" id="snip2"></a>
Code Snippet 2: Creation and Initialization of Handle for Secure HTTP Client</h2>
<p>Creates an HTTP Client handle for a secure HTTP connection using the <a class="el" href="group__group__c__api__functions.html#ga541271f1a31f2c10ccd07db315301a14">cy_http_client_create</a> function.* </p><div class="fragment"><div class="line"><span class="preprocessor">#define MAKE_IPV4_ADDRESS(a, b, c, d)     ((((uint32_t) d) &lt;&lt; 24) | \</span></div><div class="line"><span class="preprocessor">                                          (((uint32_t) c) &lt;&lt; 16) | \</span></div><div class="line"><span class="preprocessor">                                          (((uint32_t) b) &lt;&lt; 8) |\</span></div><div class="line"><span class="preprocessor">                                          ((uint32_t) a))</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define SERVER_IP_ADDRESS                 MAKE_IPV4_ADDRESS(192, 168, 18, 9)</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define SERVER_HOST                       &quot;httpbin.org&quot;</span></div><div class="line"><span class="preprocessor">#define SERVER_PORT                       443</span></div><div class="line"></div><div class="line"><span class="comment">/* Configure the following credentials for a secure HTTP connection. */</span></div><div class="line"><span class="comment">/* SSL server certificate. */</span></div><div class="line"><span class="preprocessor">#define SSL_SERVERCERT_PEM      \</span></div><div class="line"><span class="preprocessor">&quot;-----BEGIN CERTIFICATE-----\n&quot; \</span></div><div class="line"><span class="preprocessor">&quot;........base64 data........\n&quot; \</span></div><div class="line"><span class="preprocessor">&quot;-----END CERTIFICATE-----&quot;</span></div><div class="line"></div><div class="line"><span class="comment">/* SSL server private key. */</span></div><div class="line"><span class="preprocessor">#define SSL_SERVERKEY_PEM          \</span></div><div class="line"><span class="preprocessor">&quot;-----BEGIN RSA PRIVATE KEY-----\n&quot; \</span></div><div class="line"><span class="preprocessor">&quot;..........base64 data..........\n&quot; \</span></div><div class="line"><span class="preprocessor">&quot;-----END RSA PRIVATE KEY-----&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define SSL_ROOTCA_PEM            \</span></div><div class="line"><span class="preprocessor">&quot;-----BEGIN CERTIFICATE-----\n&quot;   \</span></div><div class="line"><span class="preprocessor">&quot;........base64 data........\n&quot;   \</span></div><div class="line"><span class="preprocessor">&quot;-----END CERTIFICATE-----&quot;</span></div><div class="line"></div><div class="line">cy_awsport_ssl_credentials_t credentials;</div><div class="line">cy_awsport_server_info_t server_info;</div><div class="line"><a class="code" href="group__http__client__struct.html#gaa29452c737f81db0bc8923aa83cfe674">cy_http_client_t</a> handle;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> snippet_http_client_secure_create(<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <span class="comment">/* Status variables for various operations. */</span></div><div class="line">    cy_rslt_t TestRes = CY_RSLT_ERROR;</div><div class="line">    <a class="code" href="group__http__client__struct.html#ga7c94995072a4ae648de3644d2e573847">cy_http_disconnect_callback_t</a> http_cb;</div><div class="line">    (void)TestRes;</div><div class="line"></div><div class="line">    ( void ) memset( &amp;credentials, 0, <span class="keyword">sizeof</span>( credentials ) );</div><div class="line">    ( void ) memset( &amp;server_info, 0, <span class="keyword">sizeof</span>( server_info ) );</div><div class="line"></div><div class="line">    <span class="comment">/* Set the credential information. */</span></div><div class="line">    credentials.client_cert = (<span class="keyword">const</span> <span class="keywordtype">char</span> *) &amp;SSL_SERVERCERT_PEM;</div><div class="line">    credentials.client_cert_size = <span class="keyword">sizeof</span>( SSL_SERVERCERT_PEM );</div><div class="line">    credentials.private_key = (<span class="keyword">const</span> <span class="keywordtype">char</span> *) &amp;SSL_SERVERKEY_PEM;</div><div class="line">    credentials.private_key_size = <span class="keyword">sizeof</span>( SSL_SERVERKEY_PEM );</div><div class="line">    credentials.root_ca = (<span class="keyword">const</span> <span class="keywordtype">char</span> *) &amp;SSL_ROOTCA_PEM;</div><div class="line">    credentials.root_ca_size = <span class="keyword">sizeof</span>( SSL_ROOTCA_PEM );</div><div class="line"></div><div class="line">    server_info.host_name = SERVER_HOST;</div><div class="line">    server_info.port = SERVER_PORT;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the HTTP Client Library. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga1d24d8ba5a892e85ef97877fb0b21482">cy_http_client_init</a>();</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    http_cb = disconnect_callback;</div><div class="line"></div><div class="line">    <span class="comment">/* Create an instance of the HTTP client. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga541271f1a31f2c10ccd07db315301a14">cy_http_client_create</a>(&amp;credentials, &amp;server_info, http_cb, NULL, &amp;handle);</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path */</span></div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --> <h2><a class="anchor" id="snip3"></a>
Code Snippet 3: Establish connection to the given server</h2>
<p>Establish connection of http client to given HTTP server using the <a class="el" href="group__group__c__api__functions.html#ga854f05c69a7859ed841b7a54291481dc">cy_http_client_connect</a> function.* </p><div class="fragment"><div class="line"><span class="preprocessor">#define MAKE_IPV4_ADDRESS(a, b, c, d)     ((((uint32_t) d) &lt;&lt; 24) | \</span></div><div class="line"><span class="preprocessor">                                          (((uint32_t) c) &lt;&lt; 16) | \</span></div><div class="line"><span class="preprocessor">                                          (((uint32_t) b) &lt;&lt; 8) |\</span></div><div class="line"><span class="preprocessor">                                          ((uint32_t) a))</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define SERVER_IP_ADDRESS                 MAKE_IPV4_ADDRESS(192, 168, 18, 9)</span></div><div class="line"><span class="preprocessor">#define SERVER_HOST                       &quot;httpbin.org&quot;</span></div><div class="line"><span class="preprocessor">#define SERVER_PORT                       80</span></div><div class="line"><span class="preprocessor">#define TRANSPORT_SEND_RECV_TIMEOUT_MS    ( 5000 )</span></div><div class="line"></div><div class="line">cy_awsport_ssl_credentials_t credentials;</div><div class="line">cy_awsport_server_info_t server_info;</div><div class="line"><a class="code" href="group__http__client__struct.html#gaa29452c737f81db0bc8923aa83cfe674">cy_http_client_t</a> handle;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> snippet_http_client_connect( <span class="keywordtype">void</span> )</div><div class="line">{</div><div class="line">    <span class="comment">/* Status variables for various operations. */</span></div><div class="line">    cy_rslt_t TestRes = CY_RSLT_SUCCESS;</div><div class="line">    (void)TestRes;</div><div class="line"></div><div class="line">    server_info.host_name = SERVER_HOST;</div><div class="line">    server_info.port = SERVER_PORT;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the HTTP Client Library. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga1d24d8ba5a892e85ef97877fb0b21482">cy_http_client_init</a>();</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Create an instance of the HTTP client. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga541271f1a31f2c10ccd07db315301a14">cy_http_client_create</a>(&amp;credentials, &amp;server_info, NULL, NULL, &amp;handle);</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Connect the HTTP client to server. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga854f05c69a7859ed841b7a54291481dc">cy_http_client_connect</a>(handle, TRANSPORT_SEND_RECV_TIMEOUT_MS, TRANSPORT_SEND_RECV_TIMEOUT_MS);</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line"></div><div class="line">}</div></div><!-- fragment --> <h2><a class="anchor" id="snip4"></a>
Code Snippet 4: Generation of HTTP request header</h2>
<p>Generate HTTP request header with the provided input using the <a class="el" href="group__group__c__api__functions.html#gad8e7c4c2893ade43db12da627c7c9871">cy_http_client_write_header</a> function.* </p><div class="fragment"><div class="line"><span class="preprocessor">#define MAKE_IPV4_ADDRESS(a, b, c, d)     ((((uint32_t) d) &lt;&lt; 24) | \</span></div><div class="line"><span class="preprocessor">                                          (((uint32_t) c) &lt;&lt; 16) | \</span></div><div class="line"><span class="preprocessor">                                          (((uint32_t) b) &lt;&lt; 8) |\</span></div><div class="line"><span class="preprocessor">                                          ((uint32_t) a))</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define SERVER_IP_ADDRESS                 MAKE_IPV4_ADDRESS(192, 168, 18, 9)</span></div><div class="line"><span class="preprocessor">#define SERVER_HOST                       &quot;httpbin.org&quot;</span></div><div class="line"><span class="preprocessor">#define SERVER_PORT                       80</span></div><div class="line"><span class="preprocessor">#define TRANSPORT_SEND_RECV_TIMEOUT_MS    ( 5000 )</span></div><div class="line"><span class="preprocessor">#define GET_PATH                          &quot;/get&quot;</span></div><div class="line"><span class="preprocessor">#define USER_BUFFER_LENGTH                ( 2048 )</span></div><div class="line"></div><div class="line">uint8_t userBuffer[ USER_BUFFER_LENGTH ];</div><div class="line">cy_awsport_ssl_credentials_t credentials;</div><div class="line">cy_awsport_server_info_t server_info;</div><div class="line"><a class="code" href="group__http__client__struct.html#gaa29452c737f81db0bc8923aa83cfe674">cy_http_client_t</a> handle;</div><div class="line"><a class="code" href="structcy__http__client__request__header__t.html">cy_http_client_request_header_t</a> request;</div><div class="line"><a class="code" href="structcy__http__client__header__t.html">cy_http_client_header_t</a> header;</div><div class="line">uint32_t num_header;</div><div class="line"><a class="code" href="structcy__http__client__response__t.html">cy_http_client_response_t</a> response;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> snippet_http_client_write_header( <span class="keywordtype">void</span> )</div><div class="line">{</div><div class="line">    <span class="comment">/* Status variables for various operations. */</span></div><div class="line">    cy_rslt_t TestRes = CY_RSLT_SUCCESS;</div><div class="line">    (void)TestRes;</div><div class="line"></div><div class="line">    server_info.host_name = SERVER_HOST;</div><div class="line">    server_info.port = SERVER_PORT;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the HTTP Client Library. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga1d24d8ba5a892e85ef97877fb0b21482">cy_http_client_init</a>();</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Create an instance of the HTTP client. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga541271f1a31f2c10ccd07db315301a14">cy_http_client_create</a>(&amp;credentials, &amp;server_info, NULL, NULL, &amp;handle);</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Connect the HTTP client to server. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga854f05c69a7859ed841b7a54291481dc">cy_http_client_connect</a>(handle, TRANSPORT_SEND_RECV_TIMEOUT_MS, TRANSPORT_SEND_RECV_TIMEOUT_MS);</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#a373b44e886fc3768307fe7e9bbc5b29b">buffer</a> = userBuffer;</div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#afff67fe989c5b0286f6af9ec91f4961f">buffer_len</a> = USER_BUFFER_LENGTH;</div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#a68d5f01fd0868b407533fe6bc25b5a11">headers_len</a> = 0;</div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#ac8ddc0da69b43b39e8e23a52e2d4cf4a">method</a> = <a class="code" href="group__http__client__struct.html#gga5afd8642fb8bbb246c21b7b4d2a4b719a4c8f9e137082ad383df25f24ed6da6df">CY_HTTP_CLIENT_METHOD_GET</a>;</div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#a26c4f406a67af82b2f2b12c1f777cb6d">range_end</a> = -1;</div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#a653d7e0ad35b2f924dd8b00032184a5c">range_start</a> = 0;</div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#a896d53cd2f84e9b869bec1677af967a7">resource_path</a> = GET_PATH;</div><div class="line"></div><div class="line">    header.<a class="code" href="structcy__http__client__header__t.html#aefc62bb55f7881455d95774bd158db7c">field</a> = <span class="stringliteral">&quot;Connection&quot;</span>;</div><div class="line">    header.<a class="code" href="structcy__http__client__header__t.html#a678d4c2918d66d359bbf961c61d958fe">field_len</a> = strlen(<span class="stringliteral">&quot;Connection&quot;</span>);</div><div class="line">    header.<a class="code" href="structcy__http__client__header__t.html#a2508f5b766244920921f49bce555004a">value</a> = <span class="stringliteral">&quot;keep-alive&quot;</span>;</div><div class="line">    header.<a class="code" href="structcy__http__client__header__t.html#a76ac5ffe93c7f35ac58ae314c03e384e">value_len</a> = strlen(<span class="stringliteral">&quot;keep-alive&quot;</span>);</div><div class="line">    num_header = 1;</div><div class="line"></div><div class="line">    <span class="comment">/* Generate the standard header and user-defined header and update in the request structure. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#gad8e7c4c2893ade43db12da627c7c9871">cy_http_client_write_header</a>(handle, &amp;request, &amp;header, num_header);</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --> <h2><a class="anchor" id="snip5"></a>
Code Snippet 5: Send a HTTP request to server</h2>
<p>Send a HTTP request (header + body) to the server and receive response by using <a class="el" href="group__group__c__api__functions.html#ga7bed0b2dfd40997c8471fc60ae27efb9">cy_http_client_send</a> function.* </p><div class="fragment"><div class="line"><span class="preprocessor">#define MAKE_IPV4_ADDRESS(a, b, c, d)     ((((uint32_t) d) &lt;&lt; 24) | \</span></div><div class="line"><span class="preprocessor">                                          (((uint32_t) c) &lt;&lt; 16) | \</span></div><div class="line"><span class="preprocessor">                                          (((uint32_t) b) &lt;&lt; 8) |\</span></div><div class="line"><span class="preprocessor">                                          ((uint32_t) a))</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define SERVER_IP_ADDRESS                 MAKE_IPV4_ADDRESS(192, 168, 18, 9)</span></div><div class="line"><span class="preprocessor">#define SERVER_HOST                       &quot;httpbin.org&quot;</span></div><div class="line"><span class="preprocessor">#define SERVER_PORT                       80</span></div><div class="line"><span class="preprocessor">#define TRANSPORT_SEND_RECV_TIMEOUT_MS    ( 5000 )</span></div><div class="line"><span class="preprocessor">#define GET_PATH                          &quot;/get&quot;</span></div><div class="line"><span class="preprocessor">#define USER_BUFFER_LENGTH                ( 2048 )</span></div><div class="line"><span class="preprocessor">#define REQUEST_BODY                      &quot;Hello, world!&quot;</span></div><div class="line"><span class="preprocessor">#define REQUEST_BODY_LENGTH        ( sizeof( REQUEST_BODY ) - 1 )</span></div><div class="line"></div><div class="line">uint8_t userBuffer[ USER_BUFFER_LENGTH ];</div><div class="line">cy_awsport_ssl_credentials_t credentials;</div><div class="line">cy_awsport_server_info_t server_info;</div><div class="line"><a class="code" href="group__http__client__struct.html#gaa29452c737f81db0bc8923aa83cfe674">cy_http_client_t</a> handle;</div><div class="line"><a class="code" href="structcy__http__client__request__header__t.html">cy_http_client_request_header_t</a> request;</div><div class="line"><a class="code" href="structcy__http__client__header__t.html">cy_http_client_header_t</a> header;</div><div class="line">uint32_t num_header;</div><div class="line"><a class="code" href="structcy__http__client__response__t.html">cy_http_client_response_t</a> response;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> snippet_http_client_send( <span class="keywordtype">void</span> )</div><div class="line">{</div><div class="line">    <span class="comment">/* Status variables for various operations. */</span></div><div class="line">    cy_rslt_t TestRes = CY_RSLT_SUCCESS;</div><div class="line">    (void)TestRes;</div><div class="line"></div><div class="line">    server_info.host_name = SERVER_HOST;</div><div class="line">    server_info.port = SERVER_PORT;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the HTTP Client Library. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga1d24d8ba5a892e85ef97877fb0b21482">cy_http_client_init</a>();</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Create an instance of HTTP client. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga541271f1a31f2c10ccd07db315301a14">cy_http_client_create</a>(&amp;credentials, &amp;server_info, NULL, NULL, &amp;handle);</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Connect HTTP client to server. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga854f05c69a7859ed841b7a54291481dc">cy_http_client_connect</a>(handle, TRANSPORT_SEND_RECV_TIMEOUT_MS, TRANSPORT_SEND_RECV_TIMEOUT_MS);</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#a373b44e886fc3768307fe7e9bbc5b29b">buffer</a> = userBuffer;</div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#afff67fe989c5b0286f6af9ec91f4961f">buffer_len</a> = USER_BUFFER_LENGTH;</div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#a68d5f01fd0868b407533fe6bc25b5a11">headers_len</a> = 0;</div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#ac8ddc0da69b43b39e8e23a52e2d4cf4a">method</a> = <a class="code" href="group__http__client__struct.html#gga5afd8642fb8bbb246c21b7b4d2a4b719a4c8f9e137082ad383df25f24ed6da6df">CY_HTTP_CLIENT_METHOD_GET</a>;</div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#a26c4f406a67af82b2f2b12c1f777cb6d">range_end</a> = -1;</div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#a653d7e0ad35b2f924dd8b00032184a5c">range_start</a> = 0;</div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#a896d53cd2f84e9b869bec1677af967a7">resource_path</a> = GET_PATH;</div><div class="line"></div><div class="line">    header.<a class="code" href="structcy__http__client__header__t.html#aefc62bb55f7881455d95774bd158db7c">field</a> = <span class="stringliteral">&quot;Connection&quot;</span>;</div><div class="line">    header.<a class="code" href="structcy__http__client__header__t.html#a678d4c2918d66d359bbf961c61d958fe">field_len</a> = strlen(<span class="stringliteral">&quot;Connection&quot;</span>);</div><div class="line">    header.<a class="code" href="structcy__http__client__header__t.html#a2508f5b766244920921f49bce555004a">value</a> = <span class="stringliteral">&quot;keep-alive&quot;</span>;</div><div class="line">    header.<a class="code" href="structcy__http__client__header__t.html#a76ac5ffe93c7f35ac58ae314c03e384e">value_len</a> = strlen(<span class="stringliteral">&quot;keep-alive&quot;</span>);</div><div class="line">    num_header = 1;</div><div class="line"></div><div class="line">    <span class="comment">/* Generate the standard header and user-defined header, and update in the request structure. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#gad8e7c4c2893ade43db12da627c7c9871">cy_http_client_write_header</a>(handle, &amp;request, &amp;header, num_header);</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Send the HTTP request and body to the server and receive the response from it. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga7bed0b2dfd40997c8471fc60ae27efb9">cy_http_client_send</a>(handle, &amp;request, (uint8_t *)REQUEST_BODY, REQUEST_BODY_LENGTH, &amp;response);</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --> <h2><a class="anchor" id="snip6"></a>
Code Snippet 6: Read header from the response</h2>
<p>Read HTTP header from the received response using the <a class="el" href="group__group__c__api__functions.html#gaf854997066d5ed7e85b566b9fffb218c">cy_http_client_read_header</a> function.* </p><div class="fragment"><div class="line"><span class="preprocessor">#define MAKE_IPV4_ADDRESS(a, b, c, d)     ((((uint32_t) d) &lt;&lt; 24) | \</span></div><div class="line"><span class="preprocessor">                                          (((uint32_t) c) &lt;&lt; 16) | \</span></div><div class="line"><span class="preprocessor">                                          (((uint32_t) b) &lt;&lt; 8) |\</span></div><div class="line"><span class="preprocessor">                                          ((uint32_t) a))</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define SERVER_IP_ADDRESS                 MAKE_IPV4_ADDRESS(192, 168, 18, 9)</span></div><div class="line"><span class="preprocessor">#define SERVER_HOST                       &quot;httpbin.org&quot;</span></div><div class="line"><span class="preprocessor">#define SERVER_PORT                       80</span></div><div class="line"><span class="preprocessor">#define TRANSPORT_SEND_RECV_TIMEOUT_MS    ( 5000 )</span></div><div class="line"><span class="preprocessor">#define GET_PATH                          &quot;/get&quot;</span></div><div class="line"><span class="preprocessor">#define USER_BUFFER_LENGTH                ( 2048 )</span></div><div class="line"><span class="preprocessor">#define REQUEST_BODY                      &quot;Hello, world!&quot;</span></div><div class="line"><span class="preprocessor">#define REQUEST_BODY_LENGTH        ( sizeof( REQUEST_BODY ) - 1 )</span></div><div class="line"></div><div class="line">uint8_t userBuffer[ USER_BUFFER_LENGTH ];</div><div class="line">cy_awsport_ssl_credentials_t credentials;</div><div class="line">cy_awsport_server_info_t server_info;</div><div class="line"><a class="code" href="group__http__client__struct.html#gaa29452c737f81db0bc8923aa83cfe674">cy_http_client_t</a> handle;</div><div class="line"><a class="code" href="structcy__http__client__request__header__t.html">cy_http_client_request_header_t</a> request;</div><div class="line"><a class="code" href="structcy__http__client__header__t.html">cy_http_client_header_t</a> header;</div><div class="line">uint32_t num_header;</div><div class="line"><a class="code" href="structcy__http__client__response__t.html">cy_http_client_response_t</a> response;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> snippet_http_client_read_header( <span class="keywordtype">void</span> )</div><div class="line">{</div><div class="line">    <span class="comment">/* Status variables for various operations. */</span></div><div class="line">    cy_rslt_t TestRes = CY_RSLT_SUCCESS;</div><div class="line">    (void)TestRes;</div><div class="line"></div><div class="line">    server_info.host_name = SERVER_HOST;</div><div class="line">    server_info.port = SERVER_PORT;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the HTTP Client Library. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga1d24d8ba5a892e85ef97877fb0b21482">cy_http_client_init</a>();</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Create an instance of the HTTP client. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga541271f1a31f2c10ccd07db315301a14">cy_http_client_create</a>(&amp;credentials, &amp;server_info, NULL, NULL, &amp;handle);</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Connect the HTTP client to the server. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga854f05c69a7859ed841b7a54291481dc">cy_http_client_connect</a>(handle, TRANSPORT_SEND_RECV_TIMEOUT_MS, TRANSPORT_SEND_RECV_TIMEOUT_MS);</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#a373b44e886fc3768307fe7e9bbc5b29b">buffer</a> = userBuffer;</div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#afff67fe989c5b0286f6af9ec91f4961f">buffer_len</a> = USER_BUFFER_LENGTH;</div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#a68d5f01fd0868b407533fe6bc25b5a11">headers_len</a> = 0;</div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#ac8ddc0da69b43b39e8e23a52e2d4cf4a">method</a> = <a class="code" href="group__http__client__struct.html#gga5afd8642fb8bbb246c21b7b4d2a4b719a4c8f9e137082ad383df25f24ed6da6df">CY_HTTP_CLIENT_METHOD_GET</a>;</div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#a26c4f406a67af82b2f2b12c1f777cb6d">range_end</a> = -1;</div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#a653d7e0ad35b2f924dd8b00032184a5c">range_start</a> = 0;</div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#a896d53cd2f84e9b869bec1677af967a7">resource_path</a> = GET_PATH;</div><div class="line"></div><div class="line">    header.<a class="code" href="structcy__http__client__header__t.html#aefc62bb55f7881455d95774bd158db7c">field</a> = <span class="stringliteral">&quot;Connection&quot;</span>;</div><div class="line">    header.<a class="code" href="structcy__http__client__header__t.html#a678d4c2918d66d359bbf961c61d958fe">field_len</a> = strlen(<span class="stringliteral">&quot;Connection&quot;</span>);</div><div class="line">    header.<a class="code" href="structcy__http__client__header__t.html#a2508f5b766244920921f49bce555004a">value</a> = <span class="stringliteral">&quot;keep-alive&quot;</span>;</div><div class="line">    header.<a class="code" href="structcy__http__client__header__t.html#a76ac5ffe93c7f35ac58ae314c03e384e">value_len</a> = strlen(<span class="stringliteral">&quot;keep-alive&quot;</span>);</div><div class="line">    num_header = 1;</div><div class="line"></div><div class="line">    <span class="comment">/* Generate the standard header and user-defined header, and update in the request structure. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#gad8e7c4c2893ade43db12da627c7c9871">cy_http_client_write_header</a>(handle, &amp;request, &amp;header, num_header);</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Send the HTTP request and body to the server, and receive the response from it. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga7bed0b2dfd40997c8471fc60ae27efb9">cy_http_client_send</a>(handle, &amp;request, (uint8_t *)REQUEST_BODY, REQUEST_BODY_LENGTH, &amp;response);</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    ( void ) memset( &amp;header, 0, <span class="keyword">sizeof</span>( header ) );</div><div class="line">    header.<a class="code" href="structcy__http__client__header__t.html#aefc62bb55f7881455d95774bd158db7c">field</a> = <span class="stringliteral">&quot;Connection&quot;</span>;</div><div class="line">    header.<a class="code" href="structcy__http__client__header__t.html#a678d4c2918d66d359bbf961c61d958fe">field_len</a> = strlen(<span class="stringliteral">&quot;Connection&quot;</span>);</div><div class="line">    num_header = 1;</div><div class="line"></div><div class="line">    <span class="comment">/* Read the header value from the HTTP response. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#gaf854997066d5ed7e85b566b9fffb218c">cy_http_client_read_header</a>(handle, &amp;response, &amp;header, num_header );</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --> <h2><a class="anchor" id="snip7"></a>
Code Snippet 7: Close the connection with server</h2>
<p>Disconnect from the HTTP server, and release the HTTP Client library resources by using <a class="el" href="group__group__c__api__functions.html#ga27849dabb0b78d9a7f145af192881935">cy_http_client_disconnect</a>, <a class="el" href="group__group__c__api__functions.html#ga3af8e73dc90682c81944af143a076fac">cy_http_client_delete</a> and <a class="el" href="group__group__c__api__functions.html#ga04d76cc3c966e8433ec9291e87021659">cy_http_client_deinit</a> API functions.* </p><div class="fragment"><div class="line"><span class="preprocessor">#define MAKE_IPV4_ADDRESS(a, b, c, d)     ((((uint32_t) d) &lt;&lt; 24) | \</span></div><div class="line"><span class="preprocessor">                                          (((uint32_t) c) &lt;&lt; 16) | \</span></div><div class="line"><span class="preprocessor">                                          (((uint32_t) b) &lt;&lt; 8) |\</span></div><div class="line"><span class="preprocessor">                                          ((uint32_t) a))</span></div><div class="line"></div><div class="line"><span class="preprocessor">#define SERVER_IP_ADDRESS                 MAKE_IPV4_ADDRESS(192, 168, 18, 9)</span></div><div class="line"><span class="preprocessor">#define SERVER_HOST                       &quot;httpbin.org&quot;</span></div><div class="line"><span class="preprocessor">#define SERVER_PORT                       80</span></div><div class="line"><span class="preprocessor">#define TRANSPORT_SEND_RECV_TIMEOUT_MS    ( 5000 )</span></div><div class="line"><span class="preprocessor">#define GET_PATH                          &quot;/get&quot;</span></div><div class="line"><span class="preprocessor">#define USER_BUFFER_LENGTH                ( 2048 )</span></div><div class="line"><span class="preprocessor">#define REQUEST_BODY                      &quot;Hello, world!&quot;</span></div><div class="line"><span class="preprocessor">#define REQUEST_BODY_LENGTH        ( sizeof( REQUEST_BODY ) - 1 )</span></div><div class="line"></div><div class="line">uint8_t userBuffer[ USER_BUFFER_LENGTH ];</div><div class="line">cy_awsport_ssl_credentials_t credentials;</div><div class="line">cy_awsport_server_info_t server_info;</div><div class="line"><a class="code" href="group__http__client__struct.html#gaa29452c737f81db0bc8923aa83cfe674">cy_http_client_t</a> handle;</div><div class="line"><a class="code" href="structcy__http__client__request__header__t.html">cy_http_client_request_header_t</a> request;</div><div class="line"><a class="code" href="structcy__http__client__header__t.html">cy_http_client_header_t</a> header;</div><div class="line">uint32_t num_header;</div><div class="line"><a class="code" href="structcy__http__client__response__t.html">cy_http_client_response_t</a> response;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> snippet_http_client_teardown( <span class="keywordtype">void</span> )</div><div class="line">{</div><div class="line">    <span class="comment">/* Status variables for various operations. */</span></div><div class="line">    cy_rslt_t TestRes = CY_RSLT_SUCCESS;</div><div class="line">    (void)TestRes;</div><div class="line"></div><div class="line">    server_info.host_name = SERVER_HOST;</div><div class="line">    server_info.port = SERVER_PORT;</div><div class="line"></div><div class="line">    <span class="comment">/* Initialize the HTTP Client Library. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga1d24d8ba5a892e85ef97877fb0b21482">cy_http_client_init</a>();</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Create an instance of the HTTP client. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga541271f1a31f2c10ccd07db315301a14">cy_http_client_create</a>(&amp;credentials, &amp;server_info, NULL, NULL, &amp;handle);</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Connect the HTTP client to the server. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga854f05c69a7859ed841b7a54291481dc">cy_http_client_connect</a>(handle, TRANSPORT_SEND_RECV_TIMEOUT_MS, TRANSPORT_SEND_RECV_TIMEOUT_MS);</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#a373b44e886fc3768307fe7e9bbc5b29b">buffer</a> = userBuffer;</div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#afff67fe989c5b0286f6af9ec91f4961f">buffer_len</a> = USER_BUFFER_LENGTH;</div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#a68d5f01fd0868b407533fe6bc25b5a11">headers_len</a> = 0;</div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#ac8ddc0da69b43b39e8e23a52e2d4cf4a">method</a> = <a class="code" href="group__http__client__struct.html#gga5afd8642fb8bbb246c21b7b4d2a4b719a4c8f9e137082ad383df25f24ed6da6df">CY_HTTP_CLIENT_METHOD_GET</a>;</div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#a26c4f406a67af82b2f2b12c1f777cb6d">range_end</a> = -1;</div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#a653d7e0ad35b2f924dd8b00032184a5c">range_start</a> = 0;</div><div class="line">    request.<a class="code" href="structcy__http__client__request__header__t.html#a896d53cd2f84e9b869bec1677af967a7">resource_path</a> = GET_PATH;</div><div class="line"></div><div class="line">    header.<a class="code" href="structcy__http__client__header__t.html#aefc62bb55f7881455d95774bd158db7c">field</a> = <span class="stringliteral">&quot;Connection&quot;</span>;</div><div class="line">    header.<a class="code" href="structcy__http__client__header__t.html#a678d4c2918d66d359bbf961c61d958fe">field_len</a> = strlen(<span class="stringliteral">&quot;Connection&quot;</span>);</div><div class="line">    header.<a class="code" href="structcy__http__client__header__t.html#a2508f5b766244920921f49bce555004a">value</a> = <span class="stringliteral">&quot;keep-alive&quot;</span>;</div><div class="line">    header.<a class="code" href="structcy__http__client__header__t.html#a76ac5ffe93c7f35ac58ae314c03e384e">value_len</a> = strlen(<span class="stringliteral">&quot;keep-alive&quot;</span>);</div><div class="line">    num_header = 1;</div><div class="line"></div><div class="line">    <span class="comment">/* Generate the standard header and user-defined header, and update in the request structure. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#gad8e7c4c2893ade43db12da627c7c9871">cy_http_client_write_header</a>(handle, &amp;request, &amp;header, num_header);</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Send the HTTP request and body to the server, and receive the response from it. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga7bed0b2dfd40997c8471fc60ae27efb9">cy_http_client_send</a>(handle, &amp;request, (uint8_t *)REQUEST_BODY, REQUEST_BODY_LENGTH, &amp;response);</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    ( void ) memset( &amp;header, 0, <span class="keyword">sizeof</span>( header ) );</div><div class="line">    header.<a class="code" href="structcy__http__client__header__t.html#aefc62bb55f7881455d95774bd158db7c">field</a> = <span class="stringliteral">&quot;Connection&quot;</span>;</div><div class="line">    header.<a class="code" href="structcy__http__client__header__t.html#a678d4c2918d66d359bbf961c61d958fe">field_len</a> = strlen(<span class="stringliteral">&quot;Connection&quot;</span>);</div><div class="line">    num_header = 1;</div><div class="line"></div><div class="line">    <span class="comment">/* Read the header value from the HTTP response. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#gaf854997066d5ed7e85b566b9fffb218c">cy_http_client_read_header</a>(handle, &amp;response, &amp;header, num_header);</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Disconnect the HTTP client from the server. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga27849dabb0b78d9a7f145af192881935">cy_http_client_disconnect</a>(handle);</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Delete the instance of the HTTP client. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga3af8e73dc90682c81944af143a076fac">cy_http_client_delete</a>(handle);</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">/* Deinit the HTTP library. */</span></div><div class="line">    TestRes = <a class="code" href="group__group__c__api__functions.html#ga04d76cc3c966e8433ec9291e87021659">cy_http_client_deinit</a>();</div><div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div><div class="line">    {</div><div class="line">        <span class="comment">/* Failure path. */</span></div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --></div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath">
    <ul>
        <li class="footer">
            Generated for <b>HTTP Client Middleware Library</b> by <b>Cypress Semiconductor Corporation</b>.
            All rights reserved.
        </li>
    </ul>
</div>
</body>
</html>
